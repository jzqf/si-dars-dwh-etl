<transformation>
  <info>
    <name>tr_log_table_progress</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/generic</directory>
    <parameters>
      <parameter>
        <name>PARAM_CHECK_FOR_SHUTDOWN_REQUEST</name>
        <default_value>N</default_value>
        <description>If "Y", a shutdown request will be checked for in this transformation</description>
      </parameter>
      <parameter>
        <name>PARAM_ETL_OPERATION</name>
        <default_value />
        <description>ETL operation currently being performed, e.g., "insert"  or "update"</description>
      </parameter>
      <parameter>
        <name>PARAM_ETL_RUN_ID</name>
        <default_value />
        <description>Primary key for the ${QF_ETL_DB_SCHEMA}.etl_run row for the current "run"</description>
      </parameter>
      <parameter>
        <name>PARAM_SOURCE_DB_DATABASE</name>
        <default_value />
        <description>Name of source DB</description>
      </parameter>
      <parameter>
        <name>PARAM_SOURCE_DB_ID</name>
        <default_value />
        <description>ID the "source" database containing tables will be mirrored to a "target" database</description>
      </parameter>
      <parameter>
        <name>PARAM_SOURCE_SCHEMA</name>
        <default_value />
        <description>Name of schema containing source table to mirror to target table</description>
      </parameter>
      <parameter>
        <name>PARAM_SOURCE_TABLE</name>
        <default_value />
        <description>Name of source table to mirror to target table</description>
      </parameter>
      <parameter>
        <name>PARAM_TARGET_DB_DATABASE</name>
        <default_value />
        <description>Name of target DB</description>
      </parameter>
      <parameter>
        <name>PARAM_TARGET_DB_ID</name>
        <default_value />
        <description>ID of the "target" database to which "source" DB tables will be archived/mirrored</description>
      </parameter>
      <parameter>
        <name>PARAM_TARGET_SCHEMA</name>
        <default_value />
        <description>Name of schema containing target table to update</description>
      </parameter>
      <parameter>
        <name>PARAM_TARGET_TABLE</name>
        <default_value />
        <description>Name of target table to update</description>
      </parameter>
      <parameter>
        <name>PARAM_TARGET_TABLE_UPDATE_ID</name>
        <default_value />
        <description>Primary key of ${QF_ETL_DB_SCHEMA}.target_table_update row to be updated by this job for progress and summary statistics</description>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection>${QF_LOGGING_DB_CONNECTION}</connection>
        <schema>${QF_LOG_TRANS_SCHEMA}</schema>
        <table>${QF_LOG_TRANS_TABLE}</table>
        <size_limit_lines />
        <interval />
        <timeout_days>${QF_LOG_TRANS_TIMEOUT_IN_DAYS}</timeout_days>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection>${QF_LOGGING_DB_CONNECTION}</connection>
        <schema>${QF_LOG_TRANSPERF_SCHEMA}</schema>
        <table>${QF_LOG_TRANSPERF_TABLE}</table>
        <interval />
        <timeout_days>${QF_LOG_TRANSPERF_TIMEOUT_IN_DAYS}</timeout_days>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection>${QF_LOGGING_DB_CONNECTION}</connection>
        <schema>${QF_LOG_CHANNEL_SCHEMA}</schema>
        <table>${QF_LOG_CHANNEL_TABLE}</table>
        <timeout_days>${QF_LOG_CHANNEL_TIMEOUT_IN_DAYS}</timeout_days>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection>${QF_LOGGING_DB_CONNECTION}</connection>
        <schema>${QF_LOG_TRANSSTEP_SCHEMA}</schema>
        <table>${QF_LOG_TRANSSTEP_TABLE}</table>
        <timeout_days>${QF_LOG_TRANSSTEP_TIMEOUT_IN_DAYS}</timeout_days>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection>${QF_LOGGING_DB_CONNECTION}</connection>
        <schema>${QF_LOG_TRANSMETRICS_SCHEMA}</schema>
        <table>${QF_LOG_TRANSMETRICS_TABLE}</table>
        <timeout_days>${QF_LOG_TRANSMETRICS_TIMEOUT_IN_DAYS}</timeout_days>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>Y</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2016/04/03 09:57:16.279</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019/10/03 14:43:46.137</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>This transformation does the following while streaming rows by an ETL algorithm:

1.	Logs progress the the current etl_run row.
2.	Logs progress by inserting an tl.target_table_progress row, but only if: QF_ETL_PROGRESS_LOG_HISTORY = Y.
3.	Checks if shutdown has been requested; if so, it initiates a shutdown. This is only done if:
	PARAM_CHECK_FOR_SHUTDOWN_REQUEST = Y.

This transformation has been written be executed via a "Simple mapping (sub-transformation)" step from ETL algorithms that stream rows.

This transformation has parameters:

PARAM_ETL_RUN_ID							Primary key for the ${QF_ETL_DB_SCHEMA}.etl_run row for the current "run"
PARAM_TARGET_TABLE_UPDATE_ID			Primary key of ${QF_ETL_DB_SCHEMA}.target_table_update row to be updated by this job for progress and summary statistics
PARAM_ETL_OPERATION						ETL operation currently being performed, e.g., "insert"  or "update"
PARAM_CHECK_FOR_SHUTDOWN_REQUEST	If "Y", a shutdown request will be checked for in this transformation
PARAM_SOURCE_DB_DATABASE				Name of source DB
PARAM_SOURCE_DB_ID						ID the "source" database containing tables will be mirrored to a "target" database
PARAM_SOURCE_SCHEMA					Name of schema containing source table to mirror to target table
PARAM_SOURCE_TABLE						Name of source table to mirror to target table
PARAM_TARGET_DB_DATABASE				Name of target DB
PARAM_TARGET_DB_ID						ID of the "target" database to which "source" DB tables will be archived/mirrored
PARAM_TARGET_SCHEMA					Name of schema containing target table to update
PARAM_TARGET_TABLE						Name of target table to update</note>
      <xloc>0</xloc>
      <yloc>0</yloc>
      <width>965</width>
      <heigth>309</heigth>
      <fontname>Ubuntu</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>This lists all the stream fields that this transformation will accept at the point where it is executed via a 
"Simple mapping (sub-transformation)" step.</note>
      <xloc>256</xloc>
      <yloc>336</yloc>
      <width>576</width>
      <heigth>36</heigth>
      <fontname>Ubuntu</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>These two "Select values" steps perform the following actions:

A.	Convert Javascript "null" fields to SQL NULLs. For some reason, this did not work with a "Null if" step.

B.	Adjust local timestamp field current_timestamp_utc to UTC timestamp. The two "Select values" 
	steps here do the following, in sequence:

	1.	Convert current_timestamp_utc to UTC time zone and at the same time change data type to String.
		This discards time zone details.
	2.	Convert current_timestamp_utc from String back to Timestamp. *This* timestamp can then be 
		assigned to a PostgreSQL "timestamp without time zone" column to represent the UTC timestamp.

	If current_timestamp_utc is simply converted to UTC time zone and then assigned to a PostgreSQL 
	"timestamp without time zone" column, the column is assigned the current *local* timestamp!</note>
      <xloc>592</xloc>
      <yloc>512</yloc>
      <width>603</width>
      <heigth>192</heigth>
      <fontname>Ubuntu</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>This is necessary because all hops to the 
"Mapping output specification" step 
must have the same fields.</note>
      <xloc>336</xloc>
      <yloc>1072</yloc>
      <width>232</width>
      <heigth>49</heigth>
      <fontname>Ubuntu</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>It is possible for more than one row to stream through this branch of the 
transformation if the sample interval QF_ETL_PROGRESS_INTERVAL_ROWS
is small. This will cause the "Set variables" step below (it sets the variable
QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION)
to throw an error because it assumes that there is only a single row in the
stream. To avoid this from happening, I add a sequence field named 
"seqnum" to the stream and then filter on seqnum=1 to select the first 
row in the stream. If there is more than one row in the stream, the 
subsequent row(s) will be discarded.</note>
      <xloc>1056</xloc>
      <yloc>768</yloc>
      <width>422</width>
      <heigth>127</heigth>
      <fontname>Ubuntu</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>etl_db</name>
    <server>${QF_ETL_DB_HOST}</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>${QF_ETL_DB_DATABASE}</database>
    <port>${QF_ETL_DB_PORT}</port>
    <username>${QF_ETL_DB_USERNAME}</username>
    <password>${QF_ETL_DB_PASSWORD}</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${QF_ETL_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>logging_db</name>
    <server>${QF_LOGGING_DB_HOST}</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>${QF_LOGGING_DB_DATABASE}</database>
    <port>${QF_LOGGING_DB_PORT}</port>
    <username>${QF_LOGGING_DB_USERNAME}</username>
    <password>${QF_LOGGING_DB_PASSWORD}</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${QF_LOGGING_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Get progress_milliseconds for prevous row</from>
      <to>Compute progress stats</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set row time in ms</from>
      <to>Get progress_milliseconds for prevous row</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Mapping input specification</from>
      <to>Set row time in ms</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Create etl.target_table_progress row ?</from>
      <to>Insert etl.target_table_progress row with progress details</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Compute progress stats</from>
      <to>Get local timestamp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get local timestamp</from>
      <to>"null" -> NULL, current_timestamp_utc to UTC String</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Log progress</from>
      <to>Update etl_run row progress details</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Update etl_run row progress details</from>
      <to>Create etl.target_table_progress row ?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup etl_run row</from>
      <to>shutdown_requested = true ?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>shutdown_requested = true ?</from>
      <to>Remove shutdown-related fields</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Remove shutdown-related fields</from>
      <to>Mapping output specification</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set variable QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION</from>
      <to>Set etl_run.shutdown_initiated_at_utc</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Convert current_timestamp_utc to timestamp</from>
      <to>Log progress</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>"null" -> NULL, current_timestamp_utc to UTC String</from>
      <to>Convert current_timestamp_utc to timestamp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Create etl.target_table_progress row ?</from>
      <to>Check for shutdown request?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Insert etl.target_table_progress row with progress details</from>
      <to>Check for shutdown request?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Check for shutdown request?</from>
      <to>Mapping output specification</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Check for shutdown request?</from>
      <to>Lookup etl_run row</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set etl_run.shutdown_initiated_at_utc</from>
      <to>Log: Shutdown initiated</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Log: Shutdown initiated</from>
      <to>Abort - Shutdown requested</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add shutdown-related fields to stream</from>
      <to>Set variable QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>shutdown_requested = true ?</from>
      <to>Add sequence named "seqnum"</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add sequence named "seqnum"</from>
      <to>First row (seqnum=1) ?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>First row (seqnum=1) ?</from>
      <to>Add shutdown-related fields to stream</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>First row (seqnum=1) ?</from>
      <to>Discard extra rows</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>"null" -> NULL, current_timestamp_utc to UTC String</name>
    <type>SelectValues</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <select_unspecified>Y</select_unspecified>
      <meta>
        <name>insert_id</name>
        <rename>insert_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>last_updated_on</name>
        <rename>last_updated_on</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>progress_rows_processed_per_second</name>
        <rename>progress_rows_processed_per_second</rename>
        <type>Number</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>current_timestamp_utc</name>
        <rename>current_timestamp_utc</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone>UTC</date_format_timezone>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Abort - Shutdown requested</name>
    <type>Abort</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <row_threshold>0</row_threshold>
    <message>${QF_SHUTDOWN_REQUEST_ABORT_MSG_FROM_TRANSFORMATION}</message>
    <always_log_rows>Y</always_log_rows>
    <abort_option>ABORT_WITH_ERROR</abort_option>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Add sequence named "seqnum"</name>
    <type>Sequence</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <valuename>seqnum</valuename>
    <use_database>N</use_database>
    <connection />
    <schema />
    <seqname>SEQ_</seqname>
    <use_counter>Y</use_counter>
    <counter_name />
    <start_at>1</start_at>
    <increment_by>1</increment_by>
    <max_value>999999999</max_value>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Check for shutdown request?</name>
    <type>FilterRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <send_true_to>Lookup etl_run row</send_true_to>
    <send_false_to>Mapping output specification</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>param_check_for_shutdown_request</leftvalue>
        <function>=</function>
        <rightvalue />
        <value>
          <name>constant</name>
          <type>String</type>
          <text>Y</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask />
        </value>
      </condition>
    </compare>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Compute progress stats</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

// Input fields:
var current_row_num;
var prev_progress_milliseconds;
var progress_milliseconds;
var num_rows_to_process;

// Output fields created by this script:
var qf_etl_progress_interval_rows = parseInt(getVariable("QF_ETL_PROGRESS_INTERVAL_ROWS", "0"));
var qf_etl_progress_log_history = getVariable("QF_ETL_PROGRESS_LOG_HISTORY", "N");
var param_check_for_shutdown_request = getVariable("PARAM_CHECK_FOR_SHUTDOWN_REQUEST", "N");
var param_etl_run_id = parseInt(getVariable("PARAM_ETL_RUN_ID", "0"));
var param_target_table_update_id = parseInt(getVariable("PARAM_TARGET_TABLE_UPDATE_ID", "0"));
var param_etl_operation = getVariable("PARAM_ETL_OPERATION", "");  // e.g., "insert"  or "update"
var progress_rows_to_process_remaining = null;
var progress_interval_milliseconds = null;
var progress_rows_processed_per_second = null;

if (num_rows_to_process &amp;&amp; current_row_num) {
    progress_rows_to_process_remaining = num_rows_to_process - current_row_num;
}

if (prev_progress_milliseconds) {
    progress_interval_milliseconds = progress_milliseconds - prev_progress_milliseconds;
    if (progress_interval_milliseconds) {
        progress_rows_processed_per_second = ((qf_etl_progress_interval_rows * 1000) / progress_interval_milliseconds);
    }
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>current_row_num</name>
        <rename>current_row_num</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>prev_progress_milliseconds</name>
        <rename>prev_progress_milliseconds</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>progress_milliseconds</name>
        <rename>progress_milliseconds</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>num_rows_to_process</name>
        <rename>num_rows_to_process</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>qf_etl_progress_interval_rows</name>
        <rename>qf_etl_progress_interval_rows</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>qf_etl_progress_log_history</name>
        <rename>qf_etl_progress_log_history</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>param_check_for_shutdown_request</name>
        <rename>param_check_for_shutdown_request</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>param_etl_run_id</name>
        <rename>param_etl_run_id</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>param_target_table_update_id</name>
        <rename>param_target_table_update_id</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>param_etl_operation</name>
        <rename>param_etl_operation</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>progress_rows_to_process_remaining</name>
        <rename>progress_rows_to_process_remaining</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>progress_interval_milliseconds</name>
        <rename>progress_interval_milliseconds</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>progress_rows_processed_per_second</name>
        <rename>progress_rows_processed_per_second</rename>
        <type>Number</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Convert current_timestamp_utc to timestamp</name>
    <type>SelectValues</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <select_unspecified>Y</select_unspecified>
      <meta>
        <name>current_timestamp_utc</name>
        <rename>current_timestamp_utc</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Create etl.target_table_progress row ?</name>
    <type>FilterRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <send_true_to>Insert etl.target_table_progress row with progress details</send_true_to>
    <send_false_to>Check for shutdown request?</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>qf_etl_progress_log_history</leftvalue>
        <function>=</function>
        <rightvalue />
        <value>
          <name>constant</name>
          <type>String</type>
          <text>Y</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask />
        </value>
      </condition>
    </compare>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Discard extra rows</name>
    <type>Dummy</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>First row (seqnum=1) ?</name>
    <type>FilterRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <send_true_to>Add shutdown-related fields to stream</send_true_to>
    <send_false_to>Discard extra rows</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>seqnum</leftvalue>
        <function>=</function>
        <rightvalue />
        <value>
          <name>constant</name>
          <type>Integer</type>
          <text>1</text>
          <length>-1</length>
          <precision>0</precision>
          <isnull>N</isnull>
          <mask>####0;-####0</mask>
        </value>
      </condition>
    </compare>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Add shutdown-related fields to stream</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

// Input fields:
var shutdown_requested_by;
var shutdown_requested_at_utc;
var shutdown_reason;

// Output fields created by this script:
//
// "Shutdown requested" message for email:
var shutdown_requested_summary = "Shutdown requested by: " + shutdown_requested_by + " at: " + shutdown_requested_at_utc + ". Reason: " + shutdown_reason
//
// To set "run state" for etl_run row:
var run_state_id =  parseInt(getVariable("QF_ETL_RUN_STATE_ID_SHUTDOWN_INITIATED", "0"));

// Set variable with scope "root job". The variable will be valid
// in the root job and all the child jobs and transformations.
// Possible scopes:
//   "s": system-wide
//   "r": up to the root job
//   "p": up to the parent job
//   "g": up to the grandparent job
//
// Set the variables that will be displayed in the Q-Free "failure" e-mail notification:
//Alert("shutdown_requested_summary = " + shutdown_requested_summary);
// This does not seem to work, so I have commented it out:
//setVariable("QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION", shutdown_requested_summary, "r");
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>shutdown_requested_by</name>
        <rename>shutdown_requested_by</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>shutdown_requested_at_utc</name>
        <rename>shutdown_requested_at_utc</rename>
        <type>Timestamp</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>shutdown_reason</name>
        <rename>shutdown_reason</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>shutdown_requested_summary</name>
        <rename>shutdown_requested_summary</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>run_state_id</name>
        <rename>run_state_id</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>928</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get local timestamp</name>
    <type>SystemInfo</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>current_timestamp_utc</name>
        <type>system date (variable)</type>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get progress_milliseconds for prevous row</name>
    <type>AnalyticQuery</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <group>
      </group>
    <fields>
      <field>
        <aggregate>prev_progress_milliseconds</aggregate>
        <subject>progress_milliseconds</subject>
        <type>LAG</type>
        <valuefield>1</valuefield>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert etl.target_table_progress row with progress details</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>etl_db</connection>
    <schema>${QF_ETL_DB_SCHEMA}</schema>
    <table>target_table_progress</table>
    <commit>1</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>target_table_update_id</column_name>
        <stream_name>param_target_table_update_id</stream_name>
      </field>
      <field>
        <column_name>progress_etl_operation</column_name>
        <stream_name>param_etl_operation</stream_name>
      </field>
      <field>
        <column_name>progress_insert_id</column_name>
        <stream_name>insert_id</stream_name>
      </field>
      <field>
        <column_name>progress_last_updated_on</column_name>
        <stream_name>last_updated_on</stream_name>
      </field>
      <field>
        <column_name>progress_rows_processed_per_update</column_name>
        <stream_name>qf_etl_progress_interval_rows</stream_name>
      </field>
      <field>
        <column_name>progress_rows_processed</column_name>
        <stream_name>current_row_num</stream_name>
      </field>
      <field>
        <column_name>progress_rows_to_process_remaining</column_name>
        <stream_name>progress_rows_to_process_remaining</stream_name>
      </field>
      <field>
        <column_name>progress_rows_processed_per_second</column_name>
        <stream_name>progress_rows_processed_per_second</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Log progress</name>
    <type>WriteToLog</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <loglevel>log_level_minimal</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>0</limitRowsNumber>
    <logmessage>${PARAM_DYN_DB_CONN_SOURCE_DB_DATABASE}.${PARAM_SOURCE_SCHEMA}.${PARAM_SOURCE_TABLE} -> ${PARAM_DYN_DB_CONN_TARGET_DB_DATABASE}.${PARAM_TARGET_SCHEMA}.${PARAM_TARGET_TABLE}</logmessage>
    <fields>
      <field>
        <name>current_row_num</name>
      </field>
      <field>
        <name>num_rows_to_process</name>
      </field>
      <field>
        <name>insert_id</name>
      </field>
      <field>
        <name>last_updated_on</name>
      </field>
      <field>
        <name>progress_milliseconds</name>
      </field>
      <field>
        <name>prev_progress_milliseconds</name>
      </field>
      <field>
        <name>qf_etl_progress_interval_rows</name>
      </field>
      <field>
        <name>qf_etl_progress_log_history</name>
      </field>
      <field>
        <name>param_check_for_shutdown_request</name>
      </field>
      <field>
        <name>param_etl_run_id</name>
      </field>
      <field>
        <name>param_target_table_update_id</name>
      </field>
      <field>
        <name>param_etl_operation</name>
      </field>
      <field>
        <name>progress_rows_to_process_remaining</name>
      </field>
      <field>
        <name>progress_interval_milliseconds</name>
      </field>
      <field>
        <name>progress_rows_processed_per_second</name>
      </field>
      <field>
        <name>current_timestamp_utc</name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>656</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Log: Shutdown initiated</name>
    <type>WriteToLog</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <loglevel>log_level_minimal</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>0</limitRowsNumber>
    <logmessage>Shutdown initiated:</logmessage>
    <fields>
      <field>
        <name>shutdown_requested_by</name>
      </field>
      <field>
        <name>shutdown_reason</name>
      </field>
      <field>
        <name>shutdown_requested_at_utc</name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lookup etl_run row</name>
    <type>DBLookup</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>etl_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>${QF_ETL_DB_SCHEMA}</schema>
      <table>etl_run</table>
      <orderby />
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>param_etl_run_id</name>
        <field>etl_run_id</field>
        <condition>=</condition>
        <name2 />
      </key>
      <value>
        <name>shutdown_requested</name>
        <rename>shutdown_requested</rename>
        <default />
        <type>Boolean</type>
      </value>
      <value>
        <name>shutdown_requested_by</name>
        <rename>shutdown_requested_by</rename>
        <default />
        <type>String</type>
      </value>
      <value>
        <name>shutdown_reason</name>
        <rename>shutdown_reason</rename>
        <default />
        <type>String</type>
      </value>
      <value>
        <name>shutdown_requested_at_utc</name>
        <rename>shutdown_requested_at_utc</rename>
        <default />
        <type>Timestamp</type>
      </value>
    </lookup>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Mapping input specification</name>
    <type>MappingInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>current_row_num</name>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>num_rows_to_process</name>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>insert_id</name>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>last_updated_on</name>
        <type>Timestamp</type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Mapping output specification</name>
    <type>MappingOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Remove shutdown-related fields</name>
    <type>SelectValues</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>shutdown_requested</name>
      </remove>
      <remove>
        <name>shutdown_requested_by</name>
      </remove>
      <remove>
        <name>shutdown_reason</name>
      </remove>
      <remove>
        <name>shutdown_requested_at_utc</name>
      </remove>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set etl_run.shutdown_initiated_at_utc</name>
    <type>Update</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>etl_db</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field />
    <lookup>
      <schema>${QF_ETL_DB_SCHEMA}</schema>
      <table>etl_run</table>
      <key>
        <name>param_etl_run_id</name>
        <field>etl_run_id</field>
        <condition>=</condition>
        <name2 />
      </key>
      <value>
        <name>shutdown_initiated_at_utc</name>
        <rename>current_timestamp_utc</rename>
      </value>
      <value>
        <name>run_state_id</name>
        <rename>run_state_id</rename>
      </value>
      <value>
        <name>run_state_set_on_utc</name>
        <rename>current_timestamp_utc</rename>
      </value>
    </lookup>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set row time in ms</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

var progress_milliseconds = Date.now();</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>progress_milliseconds</name>
        <rename>progress_milliseconds</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set variable QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION</name>
    <type>SetVariable</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <field_name>shutdown_requested_summary</field_name>
        <variable_name>QF_MAIL_MSG_QFREE_BODY_FAILURE_EXTRA_INFO_TRANSFORMATION</variable_name>
        <variable_type>ROOT_JOB</variable_type>
        <default_value />
      </field>
    </fields>
    <use_formatting>Y</use_formatting>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update etl_run row progress details</name>
    <type>Update</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>etl_db</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field />
    <lookup>
      <schema>${QF_ETL_DB_SCHEMA}</schema>
      <table>etl_run</table>
      <key>
        <name>param_etl_run_id</name>
        <field>etl_run_id</field>
        <condition>=</condition>
        <name2 />
      </key>
      <value>
        <name>progress_etl_operation</name>
        <rename>param_etl_operation</rename>
      </value>
      <value>
        <name>progress_insert_id</name>
        <rename>insert_id</rename>
      </value>
      <value>
        <name>progress_last_updated_on</name>
        <rename>last_updated_on</rename>
      </value>
      <value>
        <name>progress_rows_processed_per_update</name>
        <rename>qf_etl_progress_interval_rows</rename>
      </value>
      <value>
        <name>progress_rows_processed</name>
        <rename>current_row_num</rename>
      </value>
      <value>
        <name>progress_rows_to_process_remaining</name>
        <rename>progress_rows_to_process_remaining</rename>
      </value>
      <value>
        <name>progress_rows_processed_per_second</name>
        <rename>progress_rows_processed_per_second</rename>
      </value>
      <value>
        <name>progress_updated_at_utc</name>
        <rename>current_timestamp_utc</rename>
      </value>
    </lookup>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>656</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>shutdown_requested = true ?</name>
    <type>FilterRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <send_true_to>Add sequence named "seqnum"</send_true_to>
    <send_false_to>Remove shutdown-related fields</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>shutdown_requested</leftvalue>
        <function>=</function>
        <rightvalue />
        <value>
          <name>constant</name>
          <type>Boolean</type>
          <text>Y</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask />
        </value>
      </condition>
    </compare>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes />
</transformation>
